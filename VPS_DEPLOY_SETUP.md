# üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –Ω–∞ VPS

## üìã –¶–µ–ª—å
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–æ–µ–∫—Ç–∞ "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ—Å—Ç–æ–≤" –Ω–∞ VPS —Ç–∞–∫, —á—Ç–æ–±—ã –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ `main` –≤–µ—Ç–∫—É GitHub, –ø—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–ª—Å—è –Ω–∞ VPS.

## ‚úÖ –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ

- ‚úÖ SSH –∫–ª—é—á –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –ø–∞—Ä–æ–ª—è
- ‚úÖ GitHub Actions workflow —Å–æ–∑–¥–∞–Ω (`.github/workflows/deploy.yml`)
- ‚úÖ Workflow –≤–∫–ª—é—á–∞–µ—Ç:
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ `main`
  - –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ GitHub UI
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π rollback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
  - Health checks –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
  - Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  - –û—á–∏—Å—Ç–∫–∞ Docker –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

## üîß –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ VPS

### 1.1 –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VPS

```bash
ssh root@5.101.4.137
```

### 1.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å VPS

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ VPS –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker
docker --version
docker compose version

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Git
git --version

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ~/public)
ls -la ~/public 2>/dev/null || echo "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
```

### 1.3 –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
curl -fsSL https://get.docker.com | sh

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
apt-get update && apt-get install -y git
```

### 1.4 –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω)

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
mkdir -p ~/public
cd ~/public

# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/dendy-san/public.git .

# –ò–ª–∏ –µ—Å–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å –¥—Ä—É–≥–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:
cd ~/public
git init
git remote add origin https://github.com/dendy-san/public.git
git fetch origin
git checkout -b main origin/main
```

### 1.5 –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª

```bash
cd ~/public

# –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
nano .env
```

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π .env —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:**

```env
# –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–ª—è production)
ENVIRONMENT=prod

# Redis
REDIS_URL=redis://redis:6379

# DeepSeek API (–æ—Å–Ω–æ–≤–Ω–æ–π)
BASE_URL=https://api.deepseek.com/v1
API_KEY=–≤–∞—à_–∫–ª—é—á_deepseek

# GPT-4o —á–µ—Ä–µ–∑ ProxyAPI (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
OPENAI_BASE_URL=https://api.proxyapi.ru/openai/v1
OPENAI_API_KEY=–≤–∞—à_–∫–ª—é—á_proxyapi

# YooKassa (–¥–ª—è –æ–ø–ª–∞—Ç—ã)
SHOP_ID=–≤–∞—à_shop_id
YOOKASSA_API_KEY=–≤–∞—à_yookassa_key

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã (–±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ Redis –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ)
W=60
Price=100
```

**–í–ê–ñ–ù–û:** 
- `ENVIRONMENT=prod` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è production
- –ó–∞–º–µ–Ω–∏—Ç–µ –≤—Å–µ `–≤–∞—à_–∫–ª—é—á_*` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏
- –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` –≤ Git!

### 1.6 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞

```bash
cd ~/public
ls -la

# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ñ–∞–π–ª—ã:
# - docker-compose.yml
# - Dockerfile
# - .env
# - frontend/
# - app/
```

## üîê –®–∞–≥ 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ GitHub

### 2.1 –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤

–ü–µ—Ä–µ–π–¥–∏—Ç–µ: https://github.com/dendy-san/public/settings/secrets/actions

### 2.2 –î–æ–±–∞–≤—å—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã

–ù–∞–∂–º–∏—Ç–µ **New repository secret** –∏ –¥–æ–±–∞–≤—å—Ç–µ:

#### 1. VPS_HOST
- **Name:** `VPS_HOST`
- **Value:** `5.101.4.137`

#### 2. VPS_USER
- **Name:** `VPS_USER`
- **Value:** `root`

#### 3. VPS_SSH_KEY
- **Name:** `VPS_SSH_KEY`
- **Value:** (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –∏–∑ —Ñ–∞–π–ª–∞ `FINAL_SETUP_INSTRUCTIONS.md`)

**–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á:**
```
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACC5MPxVr795sMhej2q06bgyRxalK2luJ4/dvZFSpb3EAQAAAJjo+Ngx6PjY
MQAAAAtzc2gtZWQyNTUxOQAAACC5MPxVr795sMhej2q06bgyRxalK2luJ4/dvZFSpb3EAQ
AAAEAtcVUh/xvLPrdNkLVTx3Lzy7iH98UFzcu5QyUj/S528Lkw/FWvv3mwyF6ParTpuDJH
FqUraW4nj929kVKlvcQBAAAAFWdpdGh1Yi1hY3Rpb25zLWRlcGxveQ==
-----END OPENSSH PRIVATE KEY-----
```

### 2.3 –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)

- **VPS_SSH_PORT** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `22`)
- **VPS_PROJECT_PATH** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `~/public`)
- **BACKEND_PORT** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `8000`)
- **FRONTEND_PORT** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `3000`)
- **ADMIN_FRONTEND_PORT** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `3001`)
- **TELEGRAM_BOT_TOKEN** (–¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
- **TELEGRAM_CHAT_ID** (–¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)

## üß™ –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–ø–ª–æ—è

### 3.1 –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ GitHub UI

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: https://github.com/dendy-san/public/actions
2. –í—ã–±–µ—Ä–∏—Ç–µ workflow: **Deploy to VPS**
3. –ù–∞–∂–º–∏—Ç–µ: **Run workflow**
4. –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ç–∫—É: **main**
5. –ù–∞–∂–º–∏—Ç–µ: **Run workflow**

### 3.2 –ò–ª–∏ —á–µ—Ä–µ–∑ push –≤ main

```bash
# –ù–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
cd "D:\001\SEAREST\–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ—Å—Ç–æ–≤\public_gen\public"

# –°–¥–µ–ª–∞–π—Ç–µ –Ω–µ–±–æ–ª—å—à–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π)
echo "# Test deploy" >> README.md

# –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏ –∑–∞–ø—É—à—å—Ç–µ
git add .
git commit -m "Test automatic deploy"
git push origin main
```

### 3.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://github.com/dendy-san/public/actions
2. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–π workflow
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
4. –ï—Å–ª–∏ –≤—Å—ë —É—Å–ø–µ—à–Ω–æ - –ø—Ä–æ–µ–∫—Ç –æ–±–Ω–æ–≤–∏–ª—Å—è –Ω–∞ VPS!

## üìä –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞** - GitHub Actions –ø–æ–ª—É—á–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–¥ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VPS** - SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
3. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏** - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ö—ç—à–∞ –∫–æ–º–º–∏—Ç–∞ –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ rollback
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞** - `git pull` –Ω–∞ VPS
5. **–ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤** - `docker compose build --no-cache`
6. **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤** - `docker compose up -d`
7. **Health checks** - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
8. **Rollback** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ) - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
9. **–û—á–∏—Å—Ç–∫–∞ Docker** - `docker system prune -af --volumes`
10. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –Ω–∞ VPS

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ VPS:

```bash
ssh root@5.101.4.137

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
cd ~/public
docker compose ps

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
docker compose logs backend
docker compose logs frontend

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
curl http://localhost:8000/health  # Backend
curl http://localhost:3000         # Frontend
```

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –î–µ–ø–ª–æ–π –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ–∫—Ä–µ—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ GitHub
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ SSH –∫–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ workflow –≤ GitHub Actions

### –ü—Ä–æ–±–ª–µ–º–∞: Health checks –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤: `docker compose logs`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç—ã –Ω–µ –∑–∞–Ω—è—Ç—ã: `netstat -tulpn | grep :8000`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª –Ω–∞ VPS

### –ü—Ä–æ–±–ª–µ–º–∞: Rollback –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª `.previous_version` —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–∞ VPS
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

## üìñ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ GitHub Actions: `GITHUB_ACTIONS_SETUP.md`
- –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: `QUICK_START_GITHUB_SECRETS.md`
- –§–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: `FINAL_SETUP_INSTRUCTIONS.md`

---

**–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π push –≤ `main` –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—å—Å—è –Ω–∞ VPS! üöÄ**

